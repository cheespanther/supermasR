  setwd("C:/R/productos")
  
  library(plyr)

productos_inventario <- read.csv("productostotales_inventario.csv")

headers <- c("id", "codigo", "producto", "costo", "precio", "proveedor", "codigo_default", "usuario", "impuestos", "stock", "stock_virtual")
colnames(productos_inventario) <- headers
  
productos_inventario$stock[is.na(productos_inventario$stock)] <- 0
productos_inventario$costo[is.na(productos_inventario$costo)] <- 0
productos_inventario$stock_virtual[is.na(productos_inventario$stock_virtual)] <- 0  
  
producto_nombre <- productos_inventario$name

coniva <- subset(productos_inventario, productos_inventario$impuestos == "IVA(16%) VENTAS")
siniva <- subset(productos_inventario, productos_inventario$impuestos == "IVA(0%) VENTAS")

price_coniva <- coniva$precio
cost_coniva <- siniva$costo

price_siniva <- siniva$precio
cost_siniva <- siniva$costo


gain_coniva <- (100*((price_coniva/1.16) - cost_coniva)/cost_coniva)
gain_siniva <- (100*(price_siniva - cost_siniva)/cost_siniva)

coniva <- rbind(coniva, gain_coniva)
  
productos_stockproveedor <<- ddply (productos_inventario, "proveedor", summarise, stock_proveedor = length(stock))
costo <<- productos_inventario$stock * productos_inventario$costo
productos_inventario$stock[is.na(stock)] <- 0
